<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>quantum++: Quantum++ - A C++11 quantum computing library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">quantum++
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">A C++11 quantum computing library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Quantum++ - A C++11 quantum computing library </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section version"><dt>Version</dt><dd>0.1 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Vlad Gheorghiu (<a href="#" onclick="location.href='mai'+'lto:'+'vgh'+'eo'+'rgh'+'@g'+'mai'+'l.'+'com'; return false;">vgheo<span style="display: none;">.nosp@m.</span>rgh@<span style="display: none;">.nosp@m.</span>gmail<span style="display: none;">.nosp@m.</span>.com</a>) </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>(c) 2013 - 2014 Vlad Gheorghiu (<a href="#" onclick="location.href='mai'+'lto:'+'vgh'+'eo'+'rgh'+'@g'+'mai'+'l.'+'com'; return false;">vgheo<span style="display: none;">.nosp@m.</span>rgh@<span style="display: none;">.nosp@m.</span>gmail<span style="display: none;">.nosp@m.</span>.com</a>)</dd></dl>
<p>An example is worth more than one thousand words :)</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="qpp_8h.html">qpp.h</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// #include &quot;MATLAB/matlab.h&quot; // support for MATLAB</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">using namespace </span>qpp;</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Qudit Teleportation</span></div>
<div class="line">    {</div>
<div class="line">        std::size_t D = 3; <span class="comment">// size of the system</span></div>
<div class="line">        std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;**** Qudit Teleportation, D = &quot;</span> &lt;&lt; D &lt;&lt; <span class="stringliteral">&quot; ****&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        <a class="code" href="namespaceqpp.html#add021f91288df8af3125cf4b2c8806e6">ket</a> mes_AB = ket::Zero(D * D); <span class="comment">// maximally entangled state resource</span></div>
<div class="line">        <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; D; i++)</div>
<div class="line">            mes_AB += <a class="code" href="namespaceqpp.html#a94ade48c09bb33df893d7ff62a098374">mket</a>({i, i}, D);</div>
<div class="line">        mes_AB /= std::sqrt((<span class="keywordtype">double</span>) D);</div>
<div class="line">        <span class="comment">// circuit that measures in the qudit Bell basis</span></div>
<div class="line">        <a class="code" href="namespaceqpp.html#a8b7b2a88cebcdddfde04c087eecf1328">cmat</a> Bell_aA = <a class="code" href="namespaceqpp.html#ac541afad6657467d9bd83c69345880a2">adjoint</a>(<a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#a043d023d0d19f5a12b4d63fc36ba32c2">CTRL</a>(<a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#abeb66223219626504ab3e2152fbd25ae">Xd</a>(D), {0}, {1}, 2, D) * <a class="code" href="namespaceqpp.html#a3b2bafdce8302c9ac34ab328ec84a3f7">kron</a>(<a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#a32b58bf718bc4681a3b3aab410ab3980">Fd</a>(D), <a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#a4c356975433e4929f12314a8b01d32a0">Id</a>(D)));</div>
<div class="line">        <a class="code" href="namespaceqpp.html#add021f91288df8af3125cf4b2c8806e6">ket</a> psi_a = <a class="code" href="namespaceqpp.html#aa8860e7f282dfd5a75b1292303bd703d">randket</a>(D); <span class="comment">// random state as input on a</span></div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; Initial state:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <a class="code" href="namespaceqpp.html#a4f1805e175751ef749374e3c8499f15d">disp</a>(psi_a) &lt;&lt; std::endl;</div>
<div class="line">        <a class="code" href="namespaceqpp.html#add021f91288df8af3125cf4b2c8806e6">ket</a> input_aAB = <a class="code" href="namespaceqpp.html#a3b2bafdce8302c9ac34ab328ec84a3f7">kron</a>(psi_a, mes_AB); <span class="comment">// joint input state aAB</span></div>
<div class="line">        <span class="comment">// output before measurement</span></div>
<div class="line">        <a class="code" href="namespaceqpp.html#add021f91288df8af3125cf4b2c8806e6">ket</a> output_aAB = <a class="code" href="namespaceqpp.html#ae8b303f3e5093c116f4b2a0e3d44bc88">apply</a>(input_aAB, Bell_aA, {0, 1}, 3, D);</div>
<div class="line">        <span class="keyword">auto</span> measured_aA = <a class="code" href="namespaceqpp.html#a27f5cf97f5ee0fbdeae163c0f77e28d6">measure</a>(<a class="code" href="namespaceqpp.html#ae846df6b2525ef728947e00c2074e8b6">ptrace2</a>(<a class="code" href="namespaceqpp.html#a4324f5182395adab0e36eede35e4fe6b">prj</a>(output_aAB), {D * D, D}), <a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#a4c356975433e4929f12314a8b01d32a0">Id</a>(D * D)); <span class="comment">// measure on aA</span></div>
<div class="line">        std::discrete_distribution&lt;std::size_t&gt; dd(measured_aA.first.begin(), measured_aA.first.end());</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; Alice&#39;s measurement probabilities: &quot;</span>;</div>
<div class="line">        std::cout &lt;&lt; <a class="code" href="namespaceqpp.html#a4f1805e175751ef749374e3c8499f15d">disp</a>(measured_aA.first, <span class="stringliteral">&quot;, &quot;</span>) &lt;&lt; std::endl;</div>
<div class="line">        std::size_t m = dd(<a class="code" href="namespaceqpp.html#ae470c1750d1cc895763d1902f3a6882d">rdevs</a>.<a class="code" href="classqpp_1_1_random_devices.html#a52ccfd3ac258f76480f1451e9972f15c">_rng</a>); <span class="comment">// sample</span></div>
<div class="line">        <span class="keyword">auto</span> midx = <a class="code" href="namespaceqpp.html#afbe051c49a6c9c5a1cbb6401f95143a8">n2multiidx</a>(m, {D, D});</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; Alice&#39;s measurement result: &quot;</span>;</div>
<div class="line">        std::cout &lt;&lt; <a class="code" href="namespaceqpp.html#a4f1805e175751ef749374e3c8499f15d">disp</a>(midx, <span class="stringliteral">&quot; &quot;</span>) &lt;&lt; std::endl;</div>
<div class="line">        <span class="comment">// conditional result on B before correction</span></div>
<div class="line">        <a class="code" href="namespaceqpp.html#add021f91288df8af3125cf4b2c8806e6">ket</a> output_m_aAB = <a class="code" href="namespaceqpp.html#ae8b303f3e5093c116f4b2a0e3d44bc88">apply</a>(output_aAB, <a class="code" href="namespaceqpp.html#a4324f5182395adab0e36eede35e4fe6b">prj</a>(<a class="code" href="namespaceqpp.html#a94ade48c09bb33df893d7ff62a098374">mket</a>(midx, D)), {0, 1}, 3, D) / std::sqrt(measured_aA.first[m]);</div>
<div class="line">        <a class="code" href="namespaceqpp.html#a8b7b2a88cebcdddfde04c087eecf1328">cmat</a> correction_B = <a class="code" href="namespaceqpp.html#a3b4fd08d05e83656e8ce3153fe5a6f0b">powm</a>(<a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#ab00d8b91ac401243ae34dffac1358696">Zd</a>(D), midx[0]) * <a class="code" href="namespaceqpp.html#a3b4fd08d05e83656e8ce3153fe5a6f0b">powm</a>(<a class="code" href="namespaceqpp.html#ac541afad6657467d9bd83c69345880a2">adjoint</a>(<a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#abeb66223219626504ab3e2152fbd25ae">Xd</a>(D)), midx[1]); <span class="comment">// correction operator</span></div>
<div class="line">        <span class="comment">// apply correction on B</span></div>
<div class="line">        output_aAB = <a class="code" href="namespaceqpp.html#ae8b303f3e5093c116f4b2a0e3d44bc88">apply</a>(output_m_aAB, correction_B, {2}, 3, D);</div>
<div class="line">        <a class="code" href="namespaceqpp.html#a8b7b2a88cebcdddfde04c087eecf1328">cmat</a> rho_B = <a class="code" href="namespaceqpp.html#a89291882069b2a76650a082029dc4e94">ptrace1</a>(<a class="code" href="namespaceqpp.html#a4324f5182395adab0e36eede35e4fe6b">prj</a>(output_aAB), {D * D, D});</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; Bob&#39;s density operator: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <a class="code" href="namespaceqpp.html#a4f1805e175751ef749374e3c8499f15d">disp</a>(rho_B) &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; Norm difference: &quot;</span> &lt;&lt; <a class="code" href="namespaceqpp.html#af2e4740854c958579228593dd639aa6c">norm</a>(rho_B - <a class="code" href="namespaceqpp.html#a4324f5182395adab0e36eede35e4fe6b">prj</a>(psi_a)) &lt;&lt; std::endl; <span class="comment">// verification</span></div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Qudit Dense Coding</span></div>
<div class="line">    {</div>
<div class="line">        std::size_t D = 3; <span class="comment">// size of the system</span></div>
<div class="line">        std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;**** Qudit Dense Coding, D = &quot;</span> &lt;&lt; D &lt;&lt; <span class="stringliteral">&quot; ****&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        <a class="code" href="namespaceqpp.html#add021f91288df8af3125cf4b2c8806e6">ket</a> mes_AB = ket::Zero(D * D); <span class="comment">// maximally entangled state resource</span></div>
<div class="line">        <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; D; i++)</div>
<div class="line">            mes_AB += <a class="code" href="namespaceqpp.html#a94ade48c09bb33df893d7ff62a098374">mket</a>({i, i}, D);</div>
<div class="line">        mes_AB /= std::sqrt((<span class="keywordtype">double</span>) D);</div>
<div class="line">        <span class="comment">// circuit that measures in the qudit Bell basis</span></div>
<div class="line">        <a class="code" href="namespaceqpp.html#a8b7b2a88cebcdddfde04c087eecf1328">cmat</a> Bell_AB = <a class="code" href="namespaceqpp.html#ac541afad6657467d9bd83c69345880a2">adjoint</a>(<a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#a043d023d0d19f5a12b4d63fc36ba32c2">CTRL</a>(<a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#abeb66223219626504ab3e2152fbd25ae">Xd</a>(D), {0}, {1}, 2, D) * <a class="code" href="namespaceqpp.html#a3b2bafdce8302c9ac34ab328ec84a3f7">kron</a>(<a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#a32b58bf718bc4681a3b3aab410ab3980">Fd</a>(D), <a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#a4c356975433e4929f12314a8b01d32a0">Id</a>(D)));</div>
<div class="line">        <span class="comment">// equal probabilities of choosing a message</span></div>
<div class="line">        std::uniform_int_distribution&lt;std::size_t&gt; uid(0, D * D - 1);</div>
<div class="line">        std::size_t m_A = uid(<a class="code" href="namespaceqpp.html#ae470c1750d1cc895763d1902f3a6882d">rdevs</a>.<a class="code" href="classqpp_1_1_random_devices.html#a52ccfd3ac258f76480f1451e9972f15c">_rng</a>); <span class="comment">// sample, obtain the message index</span></div>
<div class="line">        <span class="keyword">auto</span> midx = <a class="code" href="namespaceqpp.html#afbe051c49a6c9c5a1cbb6401f95143a8">n2multiidx</a>(m_A, {D, D});</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; Alice sent: &quot;</span>;</div>
<div class="line">        std::cout &lt;&lt; <a class="code" href="namespaceqpp.html#a4f1805e175751ef749374e3c8499f15d">disp</a>(midx, <span class="stringliteral">&quot; &quot;</span>) &lt;&lt; std::endl;</div>
<div class="line">        <span class="comment">// Alice&#39;s operation</span></div>
<div class="line">        <a class="code" href="namespaceqpp.html#a8b7b2a88cebcdddfde04c087eecf1328">cmat</a> U_A = <a class="code" href="namespaceqpp.html#a3b4fd08d05e83656e8ce3153fe5a6f0b">powm</a>(<a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#ab00d8b91ac401243ae34dffac1358696">Zd</a>(D), midx[0]) * <a class="code" href="namespaceqpp.html#a3b4fd08d05e83656e8ce3153fe5a6f0b">powm</a>(<a class="code" href="namespaceqpp.html#ac541afad6657467d9bd83c69345880a2">adjoint</a>(<a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#abeb66223219626504ab3e2152fbd25ae">Xd</a>(D)), midx[1]);</div>
<div class="line">        <span class="comment">// Alice encodes the message</span></div>
<div class="line">        <a class="code" href="namespaceqpp.html#add021f91288df8af3125cf4b2c8806e6">ket</a> psi_AB = <a class="code" href="namespaceqpp.html#ae8b303f3e5093c116f4b2a0e3d44bc88">apply</a>(mes_AB, U_A, {0}, 2, D);</div>
<div class="line">        <span class="comment">// Bob measures the joint system in the qudit Bell basis</span></div>
<div class="line">        psi_AB = <a class="code" href="namespaceqpp.html#ae8b303f3e5093c116f4b2a0e3d44bc88">apply</a>(psi_AB, Bell_AB, {0, 1}, 2, D);</div>
<div class="line">        <span class="keyword">auto</span> measured = <a class="code" href="namespaceqpp.html#a27f5cf97f5ee0fbdeae163c0f77e28d6">measure</a>(psi_AB, <a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#a4c356975433e4929f12314a8b01d32a0">Id</a>(D * D));</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; Bob&#39;s measurement probabilities: &quot;</span>;</div>
<div class="line">        std::cout &lt;&lt; <a class="code" href="namespaceqpp.html#a4f1805e175751ef749374e3c8499f15d">disp</a>(measured.first, <span class="stringliteral">&quot;, &quot;</span>) &lt;&lt; std::endl;</div>
<div class="line">        <span class="comment">// Bob samples according to the measurement probabilities</span></div>
<div class="line">        std::discrete_distribution&lt;std::size_t&gt; dd(measured.first.begin(), measured.first.end());</div>
<div class="line">        std::size_t m_B = dd(<a class="code" href="namespaceqpp.html#ae470c1750d1cc895763d1902f3a6882d">rdevs</a>.<a class="code" href="classqpp_1_1_random_devices.html#a52ccfd3ac258f76480f1451e9972f15c">_rng</a>);</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; Bob received: &quot;</span>;</div>
<div class="line">        std::cout &lt;&lt; <a class="code" href="namespaceqpp.html#a4f1805e175751ef749374e3c8499f15d">disp</a>(<a class="code" href="namespaceqpp.html#afbe051c49a6c9c5a1cbb6401f95143a8">n2multiidx</a>(m_B, {D, D}), <span class="stringliteral">&quot; &quot;</span>) &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Grover&#39;s search algorithm, we time it</span></div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="classqpp_1_1_timer.html">Timer</a> t; <span class="comment">// set a timer</span></div>
<div class="line">        std::size_t n = 4; <span class="comment">// number of qubits</span></div>
<div class="line">        std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;**** Grover on n = &quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot; qubits ****&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::vector&lt;std::size_t&gt; dims(n, 2); <span class="comment">// local dimensions</span></div>
<div class="line">        std::size_t N = std::pow(2, n); <span class="comment">// number of elements in the database</span></div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; Database size: &quot;</span> &lt;&lt; N &lt;&lt; std::endl;</div>
<div class="line">        <span class="comment">// mark an element randomly</span></div>
<div class="line">        std::uniform_int_distribution&lt;std::size_t&gt; uid(0, N - 1);</div>
<div class="line">        std::size_t marked = uid(<a class="code" href="namespaceqpp.html#ae470c1750d1cc895763d1902f3a6882d">rdevs</a>.<a class="code" href="classqpp_1_1_random_devices.html#a52ccfd3ac258f76480f1451e9972f15c">_rng</a>);</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; Marked state: &quot;</span> &lt;&lt; marked &lt;&lt; <span class="stringliteral">&quot; -&gt; &quot;</span>;</div>
<div class="line">        std::cout &lt;&lt; <a class="code" href="namespaceqpp.html#a4f1805e175751ef749374e3c8499f15d">disp</a>(<a class="code" href="namespaceqpp.html#afbe051c49a6c9c5a1cbb6401f95143a8">n2multiidx</a>(marked, dims), <span class="stringliteral">&quot; &quot;</span>) &lt;&lt; std::endl;</div>
<div class="line">        <a class="code" href="namespaceqpp.html#add021f91288df8af3125cf4b2c8806e6">ket</a> psi = <a class="code" href="namespaceqpp.html#a94ade48c09bb33df893d7ff62a098374">mket</a>(<a class="code" href="namespaceqpp.html#afbe051c49a6c9c5a1cbb6401f95143a8">n2multiidx</a>(0, dims)); <span class="comment">// computational |0&gt;^\otimes n</span></div>
<div class="line">        psi = (<a class="code" href="namespaceqpp.html#ac695bd8e27cfe03265b550f62c394adb">kronpow</a>(<a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#aa6b6634f43e90069f008bdc82f98f6c5">H</a>, n) * psi).eval(); <span class="comment">// apply H^\otimes n, no aliasing</span></div>
<div class="line">        <a class="code" href="namespaceqpp.html#a8b7b2a88cebcdddfde04c087eecf1328">cmat</a> G = 2 * <a class="code" href="namespaceqpp.html#a4324f5182395adab0e36eede35e4fe6b">prj</a>(psi) - <a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#a4c356975433e4929f12314a8b01d32a0">Id</a>(N); <span class="comment">// Diffusion operator</span></div>
<div class="line">        <span class="comment">// number of queries</span></div>
<div class="line">        std::size_t nqueries = std::ceil(<a class="code" href="namespaceqpp.html#a73c04db6f636b236d64fddb069bef492">pi</a> * std::sqrt(N) / 4.);</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; We run &quot;</span> &lt;&lt; nqueries &lt;&lt; <span class="stringliteral">&quot; queries&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; nqueries; i++)</div>
<div class="line">        {</div>
<div class="line">            psi(marked) = -psi(marked); <span class="comment">// apply the oracle first, no aliasing</span></div>
<div class="line">            psi = (G * psi).eval(); <span class="comment">// then the diffusion operator, no aliasing</span></div>
<div class="line">        }</div>
<div class="line">        <span class="comment">// we now measure the state in the computational basis</span></div>
<div class="line">        <span class="keyword">auto</span> measured = <a class="code" href="namespaceqpp.html#a27f5cf97f5ee0fbdeae163c0f77e28d6">measure</a>(psi, <a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#a4c356975433e4929f12314a8b01d32a0">Id</a>(N));</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; Probability of the marked state: &quot;</span> &lt;&lt; measured.first[marked] &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; Probability of all results: &quot;</span>;</div>
<div class="line">        std::cout &lt;&lt; <a class="code" href="namespaceqpp.html#a4f1805e175751ef749374e3c8499f15d">disp</a>(measured.first, <span class="stringliteral">&quot;, &quot;</span>) &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; Let&#39;s sample...&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::discrete_distribution&lt;std::size_t&gt; dd(measured.first.begin(), measured.first.end());</div>
<div class="line">        std::size_t result = dd(<a class="code" href="namespaceqpp.html#ae470c1750d1cc895763d1902f3a6882d">rdevs</a>.<a class="code" href="classqpp_1_1_random_devices.html#a52ccfd3ac258f76480f1451e9972f15c">_rng</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (result == marked)</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; Hooray, we obtained the correct result: &quot;</span>;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; Not there yet... we obtained: &quot;</span>;</div>
<div class="line">        std::cout &lt;&lt; result &lt;&lt; <span class="stringliteral">&quot; -&gt; &quot;</span>;</div>
<div class="line">        std::cout &lt;&lt; <a class="code" href="namespaceqpp.html#a4f1805e175751ef749374e3c8499f15d">disp</a>(<a class="code" href="namespaceqpp.html#afbe051c49a6c9c5a1cbb6401f95143a8">n2multiidx</a>(result, dims), <span class="stringliteral">&quot; &quot;</span>) &lt;&lt; std::endl;</div>
<div class="line">        <span class="comment">// stop the timer and display it</span></div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; It took &quot;</span> &lt;&lt; t.<a class="code" href="classqpp_1_1_timer.html#ae85c057c8fdc095b0a06feefe0691a1a">toc</a>() &lt;&lt; <span class="stringliteral">&quot; seconds to simulate Grover on &quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot; qubits.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Entanglement</span></div>
<div class="line">    {</div>
<div class="line">        std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;**** Entanglement ****&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        <a class="code" href="namespaceqpp.html#a8b7b2a88cebcdddfde04c087eecf1328">cmat</a> rho = 0.2 * <a class="code" href="namespaceqpp.html#a8cf42bdf7cdbcc98543c7bf6ef36671d">st</a>.<a class="code" href="classqpp_1_1_states.html#ae65762aad4a8d049a0339f2cd09dfdda">pb00</a> + 0.8 * <a class="code" href="namespaceqpp.html#a8cf42bdf7cdbcc98543c7bf6ef36671d">st</a>.<a class="code" href="classqpp_1_1_states.html#abc38122a2e68392e6e890b8199532c6c">pb11</a>;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; rho: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <a class="code" href="namespaceqpp.html#a4f1805e175751ef749374e3c8499f15d">disp</a>(rho) &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; Concurrence of rho: &quot;</span> &lt;&lt; <a class="code" href="namespaceqpp.html#a6f899cb6e3ea3a13ffd3d8cf0a0bcc6b">concurrence</a>(rho) &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; Negativity of rho: &quot;</span> &lt;&lt; <a class="code" href="namespaceqpp.html#ae5ecdcfef5ce5a89efbebf0f4354be36">negativity</a>(rho, {2, 2}) &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; Logarithimc negativity of rho: &quot;</span> &lt;&lt; <a class="code" href="namespaceqpp.html#aba8b627b60cfe29f6062776d088cb889">lognegativity</a>(rho, {2, 2}) &lt;&lt; std::endl;</div>
<div class="line">        <a class="code" href="namespaceqpp.html#add021f91288df8af3125cf4b2c8806e6">ket</a> psi = 0.8 * <a class="code" href="namespaceqpp.html#a94ade48c09bb33df893d7ff62a098374">mket</a>({0, 0}) + 0.6 * <a class="code" href="namespaceqpp.html#a94ade48c09bb33df893d7ff62a098374">mket</a>({1, 1});</div>
<div class="line">        <span class="comment">// apply some local random unitaries</span></div>
<div class="line">        psi = <a class="code" href="namespaceqpp.html#a3b2bafdce8302c9ac34ab328ec84a3f7">kron</a>(<a class="code" href="namespaceqpp.html#a5c63023791941918aad0894de4ba1eb7">randU</a>(2), <a class="code" href="namespaceqpp.html#a5c63023791941918aad0894de4ba1eb7">randU</a>(2)) * psi;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; psi: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <a class="code" href="namespaceqpp.html#a4f1805e175751ef749374e3c8499f15d">disp</a>(psi) &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; Entanglement of psi: &quot;</span> &lt;&lt; <a class="code" href="namespaceqpp.html#a37e461b037fcb585462fa4556d792e45">entanglement</a>(psi, {2, 2}) &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; Concurrence of psi: &quot;</span> &lt;&lt; <a class="code" href="namespaceqpp.html#a6f899cb6e3ea3a13ffd3d8cf0a0bcc6b">concurrence</a>(<a class="code" href="namespaceqpp.html#a4324f5182395adab0e36eede35e4fe6b">prj</a>(psi)) &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; G-Concurrence of psi: &quot;</span> &lt;&lt; <a class="code" href="namespaceqpp.html#a100bf63d3dabba74e049aff37ea7e383">gconcurrence</a>(psi) &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; Schmidt coefficients of psi: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <a class="code" href="namespaceqpp.html#a4f1805e175751ef749374e3c8499f15d">disp</a>(<a class="code" href="namespaceqpp.html#a810c85eb9d8b64d7b42655713d7c16f3">schmidtcoeff</a>(psi, {2, 2})) &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; Schmidt probabilities of psi: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <a class="code" href="namespaceqpp.html#a4f1805e175751ef749374e3c8499f15d">disp</a>(<a class="code" href="namespaceqpp.html#ad23896bc52b516135d0ce545f8149bfc">schmidtprob</a>(psi, {2, 2})) &lt;&lt; std::endl;</div>
<div class="line">        <a class="code" href="namespaceqpp.html#a8b7b2a88cebcdddfde04c087eecf1328">cmat</a> U = <a class="code" href="namespaceqpp.html#a08b14c1fbfface136d6c42fe28461c3a">schmidtU</a>(psi, {2, 2});</div>
<div class="line">        <a class="code" href="namespaceqpp.html#a8b7b2a88cebcdddfde04c087eecf1328">cmat</a> V = <a class="code" href="namespaceqpp.html#a015680bd06d6832f6c1e8b314a74339f">schmidtV</a>(psi, {2, 2});</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; Schmidt vectors on Alice&#39;s side: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <a class="code" href="namespaceqpp.html#a4f1805e175751ef749374e3c8499f15d">disp</a>(U) &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; Schmidt vectors on Bob&#39;s side: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <a class="code" href="namespaceqpp.html#a4f1805e175751ef749374e3c8499f15d">disp</a>(V) &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; State psi in the Schmidt basis: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <a class="code" href="namespaceqpp.html#a4f1805e175751ef749374e3c8499f15d">disp</a>(<a class="code" href="namespaceqpp.html#ac541afad6657467d9bd83c69345880a2">adjoint</a>(<a class="code" href="namespaceqpp.html#a3b2bafdce8302c9ac34ab328ec84a3f7">kron</a>(U, V)) * psi) &lt;&lt; std::endl;</div>
<div class="line">        <span class="comment">// reconstructed state</span></div>
<div class="line">        <a class="code" href="namespaceqpp.html#add021f91288df8af3125cf4b2c8806e6">ket</a> psi_from_schmidt = <a class="code" href="namespaceqpp.html#a810c85eb9d8b64d7b42655713d7c16f3">schmidtcoeff</a>(psi, {2, 2})(0) * <a class="code" href="namespaceqpp.html#a3b2bafdce8302c9ac34ab328ec84a3f7">kron</a>(U.col(0), V.col(0)) +</div>
<div class="line">                <a class="code" href="namespaceqpp.html#a810c85eb9d8b64d7b42655713d7c16f3">schmidtcoeff</a>(psi, {2, 2})(1) * <a class="code" href="namespaceqpp.html#a3b2bafdce8302c9ac34ab328ec84a3f7">kron</a>(U.col(1), V.col(1));</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; State psi reconstructed from the Schmidt decomposition: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <a class="code" href="namespaceqpp.html#a4f1805e175751ef749374e3c8499f15d">disp</a>(psi_from_schmidt) &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; Norm difference: &quot;</span> &lt;&lt; <a class="code" href="namespaceqpp.html#af2e4740854c958579228593dd639aa6c">norm</a>(psi - psi_from_schmidt) &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Quantum error correcting codes</span></div>
<div class="line">    {</div>
<div class="line">        std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;**** Quantum error correcting codes ****&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        <a class="code" href="namespaceqpp.html#add021f91288df8af3125cf4b2c8806e6">ket</a> a0 = <a class="code" href="namespaceqpp.html#a3af5132edaed29c8d8233d1bb6ffa47a">codes</a>.<a class="code" href="classqpp_1_1_codes.html#a5ddc299ad4b57baa2c4fb0f0234c289e">codeword</a>(<a class="code" href="classqpp_1_1_codes.html#a85e62bf712ed89202e8d1c6cc3f3a718ab97f9ce0f85e66ca12e606039bf2af54">Codes::Type::FIVE_QUBIT</a>, 0);</div>
<div class="line">        <a class="code" href="namespaceqpp.html#add021f91288df8af3125cf4b2c8806e6">ket</a> a1 = <a class="code" href="namespaceqpp.html#a3af5132edaed29c8d8233d1bb6ffa47a">codes</a>.<a class="code" href="classqpp_1_1_codes.html#a5ddc299ad4b57baa2c4fb0f0234c289e">codeword</a>(<a class="code" href="classqpp_1_1_codes.html#a85e62bf712ed89202e8d1c6cc3f3a718ab97f9ce0f85e66ca12e606039bf2af54">Codes::Type::FIVE_QUBIT</a>, 1);</div>
<div class="line">        <a class="code" href="namespaceqpp.html#add021f91288df8af3125cf4b2c8806e6">ket</a> b0 = <a class="code" href="namespaceqpp.html#a3af5132edaed29c8d8233d1bb6ffa47a">codes</a>.<a class="code" href="classqpp_1_1_codes.html#a5ddc299ad4b57baa2c4fb0f0234c289e">codeword</a>(<a class="code" href="classqpp_1_1_codes.html#a85e62bf712ed89202e8d1c6cc3f3a718aeee75197ae019616474b4a627671805b">Codes::Type::SEVEN_QUBIT_STEANE</a>, 0);</div>
<div class="line">        <a class="code" href="namespaceqpp.html#add021f91288df8af3125cf4b2c8806e6">ket</a> b1 = <a class="code" href="namespaceqpp.html#a3af5132edaed29c8d8233d1bb6ffa47a">codes</a>.<a class="code" href="classqpp_1_1_codes.html#a5ddc299ad4b57baa2c4fb0f0234c289e">codeword</a>(<a class="code" href="classqpp_1_1_codes.html#a85e62bf712ed89202e8d1c6cc3f3a718aeee75197ae019616474b4a627671805b">Codes::Type::SEVEN_QUBIT_STEANE</a>, 1);</div>
<div class="line">        <a class="code" href="namespaceqpp.html#add021f91288df8af3125cf4b2c8806e6">ket</a> c0 = <a class="code" href="namespaceqpp.html#a3af5132edaed29c8d8233d1bb6ffa47a">codes</a>.<a class="code" href="classqpp_1_1_codes.html#a5ddc299ad4b57baa2c4fb0f0234c289e">codeword</a>(<a class="code" href="classqpp_1_1_codes.html#a85e62bf712ed89202e8d1c6cc3f3a718aa18faf404732978dbb70365fbab303bf">Codes::Type::NINE_QUBIT_SHOR</a>, 0);</div>
<div class="line">        <a class="code" href="namespaceqpp.html#add021f91288df8af3125cf4b2c8806e6">ket</a> c1 = <a class="code" href="namespaceqpp.html#a3af5132edaed29c8d8233d1bb6ffa47a">codes</a>.<a class="code" href="classqpp_1_1_codes.html#a5ddc299ad4b57baa2c4fb0f0234c289e">codeword</a>(<a class="code" href="classqpp_1_1_codes.html#a85e62bf712ed89202e8d1c6cc3f3a718aa18faf404732978dbb70365fbab303bf">Codes::Type::NINE_QUBIT_SHOR</a>, 1);</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; Five qubit [[5, 1, 3]] code. &quot;</span>;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Checking codeword orthogonality.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; &lt;0L | 1L&gt; = &quot;</span>;</div>
<div class="line">        std::cout &lt;&lt; <a class="code" href="namespaceqpp.html#a4f1805e175751ef749374e3c8499f15d">disp</a>(<a class="code" href="namespaceqpp.html#ac541afad6657467d9bd83c69345880a2">adjoint</a>(a0) * a1) &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; Seven qubit [[7, 1, 3]] Steane code. &quot;</span>;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Checking codeword orthogonality.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; &lt;0L | 1L&gt; = &quot;</span>;</div>
<div class="line">        std::cout &lt;&lt; <a class="code" href="namespaceqpp.html#a4f1805e175751ef749374e3c8499f15d">disp</a>(<a class="code" href="namespaceqpp.html#ac541afad6657467d9bd83c69345880a2">adjoint</a>(b0) * b1) &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; Nine qubit [[9, 1, 3]] Shor code. &quot;</span>;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Checking codeword orthogonality.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&gt; &lt;0L | 1L&gt; = &quot;</span>;</div>
<div class="line">        std::cout &lt;&lt; <a class="code" href="namespaceqpp.html#a4f1805e175751ef749374e3c8499f15d">disp</a>(<a class="code" href="namespaceqpp.html#ac541afad6657467d9bd83c69345880a2">adjoint</a>(c0) * c1) &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Nov 10 2014 21:35:34 for quantum++ by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.7 </li>
  </ul>
</div>
</body>
</html>
