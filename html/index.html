<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>quantum++: quantum++ - A C++11 quantum computing library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">quantum++
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">A C++11 quantum computing library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">quantum++ - A C++11 quantum computing library </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section version"><dt>Version</dt><dd>0.1 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Vlad Gheorghiu </dd></dl>
<dl class="section date"><dt>Date</dt><dd>24 October 2014</dd></dl>
<p>A simple example:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="qpp_8h.html">qpp.h</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">//#include &quot;matlab.h&quot; // support for MATLAB</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">using namespace </span>std;</div>
<div class="line"><span class="keyword">using namespace </span>qpp;</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespaceqpp.html#aad7ccc50a6b139279d7b56d07112b183">cplx</a> pow3(<span class="keyword">const</span> <a class="code" href="namespaceqpp.html#aad7ccc50a6b139279d7b56d07112b183">cplx</a>&amp; z)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> std::pow(z, 3);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Starting qpp...&quot;</span> &lt;&lt; endl;</div>
<div class="line">    <span class="comment">// output format</span></div>
<div class="line">    <span class="comment">//cout &lt;&lt; std::scientific;</span></div>
<div class="line">    cout &lt;&lt; std::fixed; <span class="comment">// use fixed format for nice formatting</span></div>
<div class="line">    cout &lt;&lt; std::setprecision(4); <span class="comment">// only for fixed or scientific modes</span></div>
<div class="line"></div>
<div class="line">    <span class="comment">// TESTING</span></div>
<div class="line">    <span class="comment">// testing channel and Gates::apply</span></div>
<div class="line">    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;Testing channel(...) and Gates::apply(...).&quot;</span> &lt;&lt; endl;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#ab0de67006716bdc8fae52c6a49259276">cmat</a> rho = <a class="code" href="namespaceqpp.html#a5751166c3171415976bd5aab3e5b70f5">randrho</a>(16);</div>
<div class="line">    <a class="code" href="namespaceqpp.html#ab0de67006716bdc8fae52c6a49259276">cmat</a> K = <a class="code" href="namespaceqpp.html#a3b2bafdce8302c9ac34ab328ec84a3f7">kron</a>(<a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#adc40cf08a8215535962bf6a42b7f532a">Id2</a>, <a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#a57f1e0fc4e5cd8ea34ffec0a5aae969c">X</a>, <a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#aadc5cf3c434afcd40c8e74b198fa59a3">Y</a>, <a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#aca1aef25a5f25b53b863d3405b7e2d1f">Z</a>);</div>
<div class="line">    vector&lt;std::size_t&gt; p = <a class="code" href="namespaceqpp.html#a6375dff8dd558f524bc0e7d3e261100f">randperm</a>(4); <span class="comment">// permutation</span></div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Permutation: &quot;</span>;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#aa2d8bf1af1766aba47d6a3c953478aaa">displn</a>(p, <span class="stringliteral">&quot;, &quot;</span>);</div>
<div class="line">    vector&lt;std::size_t&gt; invp = <a class="code" href="namespaceqpp.html#a6a2093db36b11503a66f77301fbbedb5">invperm</a>(p); <span class="comment">// inverse permutation</span></div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Inverse permutation: &quot;</span>;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#aa2d8bf1af1766aba47d6a3c953478aaa">displn</a>(invp, <span class="stringliteral">&quot;, &quot;</span>);</div>
<div class="line">    <a class="code" href="namespaceqpp.html#ab0de67006716bdc8fae52c6a49259276">cmat</a> r1 = <a class="code" href="namespaceqpp.html#af6d3ed33a419331f7e9721b5fa602e2c">channel</a>(rho, { K }, p, { 2, 2, 2, 2 });</div>
<div class="line">    <a class="code" href="namespaceqpp.html#ab0de67006716bdc8fae52c6a49259276">cmat</a> r2 = <a class="code" href="namespaceqpp.html#af97cab67fadb870ad19be297b4422ca1">syspermute</a>(<a class="code" href="namespaceqpp.html#af6d3ed33a419331f7e9721b5fa602e2c">channel</a>(<a class="code" href="namespaceqpp.html#af97cab67fadb870ad19be297b4422ca1">syspermute</a>(rho, p, { 2, 2, 2, 2 }), { K }, { 0,</div>
<div class="line">            1, 2, 3 }, { 2, 2, 2, 2 }), invp, { 2, 2, 2, 2 });</div>
<div class="line">    cout &lt;&lt; <a class="code" href="namespaceqpp.html#af2e4740854c958579228593dd639aa6c">norm</a>(r1 - r2) &lt;&lt; endl &lt;&lt; endl;</div>
<div class="line"></div>
<div class="line">    r1 = <a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#a6f774e989352cba4ce2df3c3f633a9ef">apply</a>(rho, K, p, { 2, 2, 2, 2 });</div>
<div class="line">    r2 = <a class="code" href="namespaceqpp.html#af97cab67fadb870ad19be297b4422ca1">syspermute</a>(</div>
<div class="line">            <a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#a6f774e989352cba4ce2df3c3f633a9ef">apply</a>(<a class="code" href="namespaceqpp.html#af97cab67fadb870ad19be297b4422ca1">syspermute</a>(rho, p, { 2, 2, 2, 2 }), K, { 0, 1, 2, 3 }, { 2,</div>
<div class="line">                    2, 2, 2 }), invp, { 2, 2, 2, 2 });</div>
<div class="line">    cout &lt;&lt; <a class="code" href="namespaceqpp.html#af2e4740854c958579228593dd639aa6c">norm</a>(r1 - r2) &lt;&lt; endl &lt;&lt; endl;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="namespaceqpp.html#aa2d8bf1af1766aba47d6a3c953478aaa">displn</a>(<a class="code" href="namespaceqpp.html#af6d3ed33a419331f7e9721b5fa602e2c">channel</a>(<a class="code" href="namespaceqpp.html#a4324f5182395adab0e36eede35e4fe6b">prj</a>(<a class="code" href="namespaceqpp.html#a87fa362bcdbb46150f2fe4bbd30100a0">mket</a>( { 0, 1 })), { <a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#ac23234412f4aa1068d774a6dcd9a34ec">CNOTab</a> }, { 1, 0 }, { 2, 2 }));</div>
<div class="line">    cout &lt;&lt; endl;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#aa2d8bf1af1766aba47d6a3c953478aaa">displn</a>(<a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#a6f774e989352cba4ce2df3c3f633a9ef">apply</a>(<a class="code" href="namespaceqpp.html#a87fa362bcdbb46150f2fe4bbd30100a0">mket</a>( { 0, 0 }), <a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#ac23234412f4aa1068d774a6dcd9a34ec">CNOTab</a>, { 0, 1 }, { 2, 2 }));</div>
<div class="line"></div>
<div class="line">    <span class="comment">// quantum teleportation</span></div>
<div class="line">    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;Qudit teleportation.&quot;</span> &lt;&lt; endl;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#a58c7ebc1beeae97e71328162dcc178d3">ket</a> psi = <a class="code" href="namespaceqpp.html#aa8860e7f282dfd5a75b1292303bd703d">randket</a>(2); <span class="comment">// a random state;</span></div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;|psi&gt;&lt;psi|:&quot;</span> &lt;&lt; endl;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#aa2d8bf1af1766aba47d6a3c953478aaa">displn</a>(<a class="code" href="namespaceqpp.html#a4324f5182395adab0e36eede35e4fe6b">prj</a>(psi));</div>
<div class="line">    <a class="code" href="namespaceqpp.html#ab0de67006716bdc8fae52c6a49259276">cmat</a> telecircuit = <a class="code" href="namespaceqpp.html#aa8cc881ed303bde593de0bc7a33e74c1">expandout</a>(<a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#aa6b6634f43e90069f008bdc82f98f6c5">H</a>, { 0 }, { 2, 2, 2 })</div>
<div class="line">              <a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.CTRL(<a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.X, { 0 }, { 1 }, 3);</div>
<div class="line">    <a class="code" href="namespaceqpp.html#a58c7ebc1beeae97e71328162dcc178d3">ket</a> psiin = <a class="code" href="namespaceqpp.html#a3b2bafdce8302c9ac34ab328ec84a3f7">kron</a>(psi, <a class="code" href="namespaceqpp.html#a8cf42bdf7cdbcc98543c7bf6ef36671d">st</a>.<a class="code" href="classqpp_1_1_states.html#a31f8f36c6686a86d7c79d0dcdb27f678">b00</a>); <span class="comment">// input state</span></div>
<div class="line">    <a class="code" href="namespaceqpp.html#a58c7ebc1beeae97e71328162dcc178d3">ket</a> psiout = telecircuit * psiin; <span class="comment">// output state before measurement</span></div>
<div class="line">    <span class="comment">// measure Alice&#39;s qubits, measurement results are 1 0</span></div>
<div class="line">    psiout = <a class="code" href="namespaceqpp.html#a3b2bafdce8302c9ac34ab328ec84a3f7">kron</a>(<a class="code" href="namespaceqpp.html#a4324f5182395adab0e36eede35e4fe6b">prj</a>(<a class="code" href="namespaceqpp.html#a8cf42bdf7cdbcc98543c7bf6ef36671d">st</a>.<a class="code" href="classqpp_1_1_states.html#a4d3e293b45df80aab242db13fd6d3b88">z1</a>), <a class="code" href="namespaceqpp.html#a4324f5182395adab0e36eede35e4fe6b">prj</a>(<a class="code" href="namespaceqpp.html#a8cf42bdf7cdbcc98543c7bf6ef36671d">st</a>.<a class="code" href="classqpp_1_1_states.html#a5a26315b0c7a61382289c208da681d22">z0</a>), <a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#adc40cf08a8215535962bf6a42b7f532a">Id2</a>) * psiout;</div>
<div class="line">    <span class="comment">// apply correction</span></div>
<div class="line">    psiout = <a class="code" href="namespaceqpp.html#aa8cc881ed303bde593de0bc7a33e74c1">expandout</a>(<a class="code" href="namespaceqpp.html#a3b4fd08d05e83656e8ce3153fe5a6f0b">powm</a>(<a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#aca1aef25a5f25b53b863d3405b7e2d1f">Z</a>, 1) * <a class="code" href="namespaceqpp.html#a3b4fd08d05e83656e8ce3153fe5a6f0b">powm</a>(<a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#a57f1e0fc4e5cd8ea34ffec0a5aae969c">X</a>, 0), { 2 }, { 2, 2, 2 })</div>
<div class="line">              psiout;</div>
<div class="line">    <span class="comment">// not necessary to normalize, prj() takes care of it below</span></div>
<div class="line">    <a class="code" href="namespaceqpp.html#ab0de67006716bdc8fae52c6a49259276">cmat</a> rhoout = <a class="code" href="namespaceqpp.html#a5fef47d40c93533b586f9b90a97c3621">ptrace</a>(<a class="code" href="namespaceqpp.html#a4324f5182395adab0e36eede35e4fe6b">prj</a>(psiout), { 0, 1 }, { 2, 2, 2 });</div>
<div class="line">    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;Teleported state:&quot;</span> &lt;&lt; endl;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#aa2d8bf1af1766aba47d6a3c953478aaa">displn</a>(rhoout);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Difference in norm: &quot;</span> &lt;&lt; <a class="code" href="namespaceqpp.html#af2e4740854c958579228593dd639aa6c">norm</a>(<a class="code" href="namespaceqpp.html#a4324f5182395adab0e36eede35e4fe6b">prj</a>(psi) - rhoout) &lt;&lt; endl;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// qudit measurements</span></div>
<div class="line">    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;Qudit measurements.&quot;</span> &lt;&lt; endl;</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Initially in state |0&gt;&lt;0|.&quot;</span> &lt;&lt; endl;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#a58c7ebc1beeae97e71328162dcc178d3">ket</a> zd0(3);</div>
<div class="line">    zd0 &lt;&lt; 1, 0, 0;</div>
<div class="line">    <a class="code" href="classqpp_1_1_qudit.html">Qudit</a> q(<a class="code" href="namespaceqpp.html#a4324f5182395adab0e36eede35e4fe6b">prj</a>(zd0));</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Measuring Z operator non-destructively. Results:&quot;</span> &lt;&lt; endl;</div>
<div class="line">    cout &lt;&lt; q.measure() &lt;&lt; endl;</div>
<div class="line">    cout &lt;&lt; q.measure() &lt;&lt; endl;</div>
<div class="line">    cout &lt;&lt; q.measure() &lt;&lt; endl;</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Measuring X operator non-destructively. Results:&quot;</span> &lt;&lt; endl;</div>
<div class="line">    cout &lt;&lt; q.measure(<a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#abeb66223219626504ab3e2152fbd25ae">Xd</a>(3)) &lt;&lt; endl;</div>
<div class="line">    cout &lt;&lt; q.measure(<a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#abeb66223219626504ab3e2152fbd25ae">Xd</a>(3)) &lt;&lt; endl;</div>
<div class="line">    cout &lt;&lt; q.measure(<a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#abeb66223219626504ab3e2152fbd25ae">Xd</a>(3)) &lt;&lt; endl;</div>
<div class="line">    <span class="comment">// von Neumann projective measurement</span></div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Measuring X operator destructively (collapse). Results:&quot;</span> &lt;&lt; endl;</div>
<div class="line">    cout &lt;&lt; q.measure(<a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#abeb66223219626504ab3e2152fbd25ae">Xd</a>(3), <span class="keyword">true</span>) &lt;&lt; endl;</div>
<div class="line">    cout &lt;&lt; q.measure(<a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#abeb66223219626504ab3e2152fbd25ae">Xd</a>(3)) &lt;&lt; endl;</div>
<div class="line">    cout &lt;&lt; q.measure(<a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#abeb66223219626504ab3e2152fbd25ae">Xd</a>(3)) &lt;&lt; endl;</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Finally measuring Z operator destructively. Results:&quot;</span> &lt;&lt; endl;</div>
<div class="line">    cout &lt;&lt; q.measure(<span class="keyword">true</span>) &lt;&lt; endl;</div>
<div class="line">    cout &lt;&lt; q.measure() &lt;&lt; endl;</div>
<div class="line">    cout &lt;&lt; q.measure() &lt;&lt; endl;</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Final state of qudit:&quot;</span> &lt;&lt; endl;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#aa2d8bf1af1766aba47d6a3c953478aaa">displn</a>(q.getRho());</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Bell state generator</span></div>
<div class="line">    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;Bell state generator: &quot;</span> &lt;&lt; endl;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#ab0de67006716bdc8fae52c6a49259276">cmat</a> circuit;</div>
<div class="line">    circuit = <a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#a043d023d0d19f5a12b4d63fc36ba32c2">CTRL</a>(<a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#a57f1e0fc4e5cd8ea34ffec0a5aae969c">X</a>, { 0 }, { 1 }, 2) * <a class="code" href="namespaceqpp.html#aa8cc881ed303bde593de0bc7a33e74c1">expandout</a>(<a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#aa6b6634f43e90069f008bdc82f98f6c5">H</a>, 0, { 2, 2 });</div>
<div class="line">    <a class="code" href="namespaceqpp.html#ab0de67006716bdc8fae52c6a49259276">cmat</a> input = <a class="code" href="namespaceqpp.html#a3b2bafdce8302c9ac34ab328ec84a3f7">kron</a>(<a class="code" href="namespaceqpp.html#a8cf42bdf7cdbcc98543c7bf6ef36671d">st</a>.<a class="code" href="classqpp_1_1_states.html#a5a26315b0c7a61382289c208da681d22">z0</a>, <a class="code" href="namespaceqpp.html#a8cf42bdf7cdbcc98543c7bf6ef36671d">st</a>.<a class="code" href="classqpp_1_1_states.html#a5a26315b0c7a61382289c208da681d22">z0</a>);</div>
<div class="line">    <a class="code" href="namespaceqpp.html#ab0de67006716bdc8fae52c6a49259276">cmat</a> output = circuit * input;</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Circuit matrix representation: &quot;</span> &lt;&lt; endl;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#aa2d8bf1af1766aba47d6a3c953478aaa">displn</a>(circuit);</div>
<div class="line">    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;Output (|Bell_0&gt; state) of the circuit on |00&gt;: &quot;</span> &lt;&lt; endl;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#aa2d8bf1af1766aba47d6a3c953478aaa">displn</a>(output);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// 3-qubit repetion code</span></div>
<div class="line">    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;3-qubit repetition code: &quot;</span> &lt;&lt; endl;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#ab0de67006716bdc8fae52c6a49259276">cmat</a> rep;</div>
<div class="line">    rep = <a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#a043d023d0d19f5a12b4d63fc36ba32c2">CTRL</a>(<a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#a57f1e0fc4e5cd8ea34ffec0a5aae969c">X</a>, { 0 }, { 2 }, 3) * <a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#a043d023d0d19f5a12b4d63fc36ba32c2">CTRL</a>(<a class="code" href="namespaceqpp.html#abde5be3693c953f79e9c8e262447c8d4">gt</a>.<a class="code" href="classqpp_1_1_gates.html#a57f1e0fc4e5cd8ea34ffec0a5aae969c">X</a>, { 0 }, { 1 }, 3);</div>
<div class="line">    input = <a class="code" href="namespaceqpp.html#a3b2bafdce8302c9ac34ab328ec84a3f7">kron</a>(<a class="code" href="namespaceqpp.html#a8cf42bdf7cdbcc98543c7bf6ef36671d">st</a>.<a class="code" href="classqpp_1_1_states.html#a4d3e293b45df80aab242db13fd6d3b88">z1</a>, <a class="code" href="namespaceqpp.html#a8cf42bdf7cdbcc98543c7bf6ef36671d">st</a>.<a class="code" href="classqpp_1_1_states.html#a5a26315b0c7a61382289c208da681d22">z0</a>, <a class="code" href="namespaceqpp.html#a8cf42bdf7cdbcc98543c7bf6ef36671d">st</a>.<a class="code" href="classqpp_1_1_states.html#a5a26315b0c7a61382289c208da681d22">z0</a>);</div>
<div class="line">    output = rep * input;</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Circuit acting on |000&gt; produces |111&gt;. Check: &quot;</span> &lt;&lt; endl;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#aa2d8bf1af1766aba47d6a3c953478aaa">displn</a>(output);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// functor test</span></div>
<div class="line">    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;Functor z^3 acting on:&quot;</span> &lt;&lt; endl;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#ab0de67006716bdc8fae52c6a49259276">cmat</a> a(2, 2);</div>
<div class="line">    a &lt;&lt; 1, 2, 3, 4;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#aa2d8bf1af1766aba47d6a3c953478aaa">displn</a>(a);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Result (with lambda):&quot;</span> &lt;&lt; endl;</div>
<div class="line">    <span class="comment">// functor z^3 componentwise, specify OutputScalar and Derived for lambdas</span></div>
<div class="line">    <a class="code" href="namespaceqpp.html#aa2d8bf1af1766aba47d6a3c953478aaa">displn</a>(cwise&lt;cplx, cmat&gt;(a, [](<span class="keyword">const</span> <a class="code" href="namespaceqpp.html#aad7ccc50a6b139279d7b56d07112b183">cplx</a>&amp; z)-&gt;<a class="code" href="namespaceqpp.html#aad7ccc50a6b139279d7b56d07112b183">cplx</a></div>
<div class="line">    {   <span class="keywordflow">return</span> z*z*z;}));</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Result (with proper function):&quot;</span> &lt;&lt; endl;</div>
<div class="line">    <span class="comment">// automatic type deduction for proper functions</span></div>
<div class="line">    <a class="code" href="namespaceqpp.html#aa2d8bf1af1766aba47d6a3c953478aaa">displn</a>(<a class="code" href="namespaceqpp.html#af68a93794f1719077733b79cc9f2f1df">cwise</a>(a, &amp;pow3));</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Gram-Schmidt</span></div>
<div class="line">    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;Gram-Schmidt on matrix:&quot;</span> &lt;&lt; endl;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#ab0de67006716bdc8fae52c6a49259276">cmat</a> A(3, 3);</div>
<div class="line">    A &lt;&lt; 1, 1, 0, 0, 2, 0, 0, 0, 0;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#aa2d8bf1af1766aba47d6a3c953478aaa">displn</a>(A);</div>
<div class="line">    <a class="code" href="namespaceqpp.html#ab0de67006716bdc8fae52c6a49259276">cmat</a> Ags = <a class="code" href="namespaceqpp.html#a743da9600f080b2d31951a91b0e2e59a">grams</a>(A);</div>
<div class="line">    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;Result:&quot;</span> &lt;&lt; endl;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#aa2d8bf1af1766aba47d6a3c953478aaa">displn</a>(Ags);</div>
<div class="line">    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;Projector is:&quot;</span> &lt;&lt; endl;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#aa2d8bf1af1766aba47d6a3c953478aaa">displn</a>(Ags * <a class="code" href="namespaceqpp.html#ac541afad6657467d9bd83c69345880a2">adjoint</a>(Ags));</div>
<div class="line"></div>
<div class="line">    <span class="comment">// spectral decomposition test</span></div>
<div class="line">    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;Spectral decomposition tests.&quot;</span> &lt;&lt; endl;</div>
<div class="line">    std::size_t D = 4;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#ab0de67006716bdc8fae52c6a49259276">cmat</a> rH = <a class="code" href="namespaceqpp.html#a5a2a1d87be74a4d0d3cbbca6245417b5">randH</a>(D);</div>
<div class="line">    <a class="code" href="namespaceqpp.html#a923e2becc99eb818c04c71ae913902ff">dmat</a> evalsH = <a class="code" href="namespaceqpp.html#a658ff768158a62f4767beb00a1cb1cb3">hevals</a>(rH);</div>
<div class="line">    <a class="code" href="namespaceqpp.html#ab0de67006716bdc8fae52c6a49259276">cmat</a> evectsH = <a class="code" href="namespaceqpp.html#abeadaf6395c78a52339bec119c4a331b">hevects</a>(rH);</div>
<div class="line">    <a class="code" href="namespaceqpp.html#ab0de67006716bdc8fae52c6a49259276">cmat</a> spec = cmat::Zero(D, D);</div>
<div class="line">    <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; D; i++)</div>
<div class="line">        spec += evalsH(i) * <a class="code" href="namespaceqpp.html#a4324f5182395adab0e36eede35e4fe6b">prj</a>((<a class="code" href="namespaceqpp.html#ab0de67006716bdc8fae52c6a49259276">cmat</a>) evectsH.col(i));</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Original matrix: &quot;</span> &lt;&lt; endl;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#aa2d8bf1af1766aba47d6a3c953478aaa">displn</a>(rH);</div>
<div class="line">    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;Reconstructed from spectral decomposition: &quot;</span> &lt;&lt; endl;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#aa2d8bf1af1766aba47d6a3c953478aaa">displn</a>(spec);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Difference in norm: &quot;</span> &lt;&lt; <a class="code" href="namespaceqpp.html#af2e4740854c958579228593dd639aa6c">norm</a>(spec - rH) &lt;&lt; endl;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// channel tests</span></div>
<div class="line">    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;Channel tests.&quot;</span> &lt;&lt; endl;</div>
<div class="line">    std::size_t nk = 10, d = 2; <span class="comment">// nk Kraus on d-dimensional system</span></div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Generating a random channel with &quot;</span> &lt;&lt; nk</div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot; Kraus operators on a &quot;</span> &lt;&lt; d &lt;&lt; <span class="stringliteral">&quot; dimensional space...&quot;</span> &lt;&lt; endl;</div>
<div class="line">    std::vector&lt;cmat&gt; Ks = <a class="code" href="namespaceqpp.html#a226c572a13ace4d51659439f1c482645">randkraus</a>(nk, d);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="namespaceqpp.html#ab0de67006716bdc8fae52c6a49259276">cmat</a> rho_in = <a class="code" href="namespaceqpp.html#a5751166c3171415976bd5aab3e5b70f5">randrho</a>(d); <span class="comment">// input state</span></div>
<div class="line">    <a class="code" href="namespaceqpp.html#ab0de67006716bdc8fae52c6a49259276">cmat</a> rho_out = <a class="code" href="namespaceqpp.html#af6d3ed33a419331f7e9721b5fa602e2c">channel</a>(rho_in, Ks); <span class="comment">// output state</span></div>
<div class="line"></div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Computing its Choi matrix...&quot;</span> &lt;&lt; endl;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#ab0de67006716bdc8fae52c6a49259276">cmat</a> choim = <a class="code" href="namespaceqpp.html#ac8f061a25c22b9d79d2536dc4ea738c9">choi</a>(Ks);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Choi matrix:&quot;</span> &lt;&lt; endl;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#aa2d8bf1af1766aba47d6a3c953478aaa">displn</a>(choim);</div>
<div class="line">    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;The eigenvalues of the Choi matrix are: &quot;</span> &lt;&lt; endl;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#aa2d8bf1af1766aba47d6a3c953478aaa">displn</a>(<a class="code" href="namespaceqpp.html#a7b652e3ea4b9748204359a69588a8c91">transpose</a>(<a class="code" href="namespaceqpp.html#a658ff768158a62f4767beb00a1cb1cb3">hevals</a>(choim)));</div>
<div class="line">    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;Their sum is: &quot;</span> &lt;&lt; <a class="code" href="namespaceqpp.html#a48a92e8a327ff86f87c6236965103797">sum</a>(<a class="code" href="namespaceqpp.html#a658ff768158a62f4767beb00a1cb1cb3">hevals</a>(choim)) &lt;&lt; endl;</div>
<div class="line">    std::vector&lt;cmat&gt; Kperps = <a class="code" href="namespaceqpp.html#ac08330f1578fa6b6e382a80132dffb46">choi2kraus</a>(choim);</div>
<div class="line">    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;The Kraus rank of the channel is: &quot;</span> &lt;&lt; Kperps.size()</div>
<div class="line">            &lt;&lt; endl;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#ab0de67006716bdc8fae52c6a49259276">cmat</a> rho_out1 = <a class="code" href="namespaceqpp.html#af6d3ed33a419331f7e9721b5fa602e2c">channel</a>(rho_in, Kperps);</div>
<div class="line">    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;Difference in norm on output states: &quot;</span></div>
<div class="line">            &lt;&lt; <a class="code" href="namespaceqpp.html#af2e4740854c958579228593dd639aa6c">norm</a>(rho_out1 - rho_out) &lt;&lt; endl;</div>
<div class="line">    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;Superoperator matrix:&quot;</span> &lt;&lt; endl;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#ab0de67006716bdc8fae52c6a49259276">cmat</a> smat = <a class="code" href="namespaceqpp.html#a54d1de5e72943a61c35ab634690a841b">super</a>(Ks);</div>
<div class="line">    <a class="code" href="namespaceqpp.html#aa2d8bf1af1766aba47d6a3c953478aaa">displn</a>(smat);</div>
<div class="line">    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;The eigenvalues of the superoperator matrix are: &quot;</span> &lt;&lt; endl;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#ab0de67006716bdc8fae52c6a49259276">cmat</a> evalsupop = <a class="code" href="namespaceqpp.html#af627eb43b2ea7156759aa70f671a2c58">evals</a>(smat);</div>
<div class="line">    <a class="code" href="namespaceqpp.html#aa2d8bf1af1766aba47d6a3c953478aaa">displn</a>(<a class="code" href="namespaceqpp.html#a7b652e3ea4b9748204359a69588a8c91">transpose</a>(evalsupop));</div>
<div class="line">    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;Their absolute values are: &quot;</span> &lt;&lt; endl;</div>
<div class="line">    <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; (std::size_t) evalsupop.size(); i++)</div>
<div class="line">        cout &lt;&lt; std::abs((<a class="code" href="namespaceqpp.html#aad7ccc50a6b139279d7b56d07112b183">cplx</a>) evalsupop(i)) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line">    cout &lt;&lt; endl &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;Diference in norm for superoperator action: &quot;</span>;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#ab0de67006716bdc8fae52c6a49259276">cmat</a> rho_out2 = <a class="code" href="namespaceqpp.html#a7b652e3ea4b9748204359a69588a8c91">transpose</a>(</div>
<div class="line">            (<a class="code" href="namespaceqpp.html#ab0de67006716bdc8fae52c6a49259276">cmat</a>) <a class="code" href="namespaceqpp.html#a1f5c91b44c2437627777140980cac940">reshape</a>(smat * <a class="code" href="namespaceqpp.html#a1f5c91b44c2437627777140980cac940">reshape</a>(<a class="code" href="namespaceqpp.html#a7b652e3ea4b9748204359a69588a8c91">transpose</a>(rho_in), d * d, 1), d, d));</div>
<div class="line">    cout &lt;&lt; <a class="code" href="namespaceqpp.html#af2e4740854c958579228593dd639aa6c">norm</a>(rho_out - rho_out2) &lt;&lt; endl;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// statistics tests</span></div>
<div class="line">    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;Statistics tests.&quot;</span> &lt;&lt; endl;</div>
<div class="line">    std::vector&lt;cplx&gt; ampl = { 1. + 1_i, 1. - 1_i };</div>
<div class="line">    <a class="code" href="namespaceqpp.html#ab0de67006716bdc8fae52c6a49259276">cmat</a> va(1, 4);</div>
<div class="line">    va &lt;&lt; 0.1, 1, 1. + 1_i, 1. + 2_i;</div>
<div class="line">    <a class="code" href="classqpp_1_1_discrete_distribution_abs_square.html">DiscreteDistributionAbsSquare</a> dc(va);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;The probabilities are: &quot;</span>;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#aa2d8bf1af1766aba47d6a3c953478aaa">displn</a>(dc.probabilities(), <span class="stringliteral">&quot;, &quot;</span>, <span class="stringliteral">&quot;{&quot;</span>, <span class="stringliteral">&quot;}&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">//  // TIMING tests</span></div>
<div class="line">    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;Timing tests...&quot;</span> &lt;&lt; endl;</div>
<div class="line">    std::size_t n = 12; <span class="comment">// number of qubits</span></div>
<div class="line">    std::size_t N = std::pow(2, n);</div>
<div class="line">    vector&lt;std::size_t&gt; dims(n, 2); <span class="comment">// local dimensions</span></div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;n = &quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot; qubits, matrix size &quot;</span> &lt;&lt; N &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; N &lt;&lt; <span class="stringliteral">&quot;.&quot;</span></div>
<div class="line">            &lt;&lt; endl;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// matrix initialization</span></div>
<div class="line">    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;Matrix initialization timing.&quot;</span> &lt;&lt; endl;</div>
<div class="line">    <span class="comment">// start the timer, automatic tic() in the constructor</span></div>
<div class="line">    <a class="code" href="classqpp_1_1_timer.html">Timer</a> t, total;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#ab0de67006716bdc8fae52c6a49259276">cmat</a> randcmat = cmat::Random(N, N);</div>
<div class="line">    t.<a class="code" href="classqpp_1_1_timer.html#a5b2954adbc31fba4131592609c01db32">toc</a>(); <span class="comment">// read the time</span></div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Took &quot;</span> &lt;&lt; t &lt;&lt; <span class="stringliteral">&quot; seconds.&quot;</span> &lt;&lt; endl;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// lazy matrix product</span></div>
<div class="line">    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;Lazy matrix product timing.&quot;</span> &lt;&lt; endl;</div>
<div class="line">    t.<a class="code" href="classqpp_1_1_timer.html#ae1bb3eb8a0f7851ba52005fab35e1c03">tic</a>();</div>
<div class="line">    <span class="keyword">auto</span> lazyprod = randcmat * randcmat; <span class="comment">// lazyprod has type GenMatProduct</span></div>
<div class="line">    t.<a class="code" href="classqpp_1_1_timer.html#a5b2954adbc31fba4131592609c01db32">toc</a>(); <span class="comment">// read the time</span></div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Took &quot;</span> &lt;&lt; t &lt;&lt; <span class="stringliteral">&quot; seconds.&quot;</span> &lt;&lt; endl;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// ptrace1 timing</span></div>
<div class="line">    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;ptrace1 timing.&quot;</span> &lt;&lt; endl;</div>
<div class="line">    t.<a class="code" href="classqpp_1_1_timer.html#ae1bb3eb8a0f7851ba52005fab35e1c03">tic</a>(); <span class="comment">// reset the chronometer</span></div>
<div class="line">    <span class="comment">// trace away half of the qubits</span></div>
<div class="line">    <a class="code" href="namespaceqpp.html#a89291882069b2a76650a082029dc4e94">ptrace1</a>(randcmat,</div>
<div class="line">            { (std::size_t) std::sqrt(N), (std::size_t) std::sqrt(N) });</div>
<div class="line">    t.<a class="code" href="classqpp_1_1_timer.html#a5b2954adbc31fba4131592609c01db32">toc</a>(); <span class="comment">// read the time</span></div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Took &quot;</span> &lt;&lt; t &lt;&lt; <span class="stringliteral">&quot; seconds.&quot;</span> &lt;&lt; endl;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// ptrace2 timing</span></div>
<div class="line">    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;ptrace2 timing.&quot;</span> &lt;&lt; endl;</div>
<div class="line">    t.<a class="code" href="classqpp_1_1_timer.html#ae1bb3eb8a0f7851ba52005fab35e1c03">tic</a>(); <span class="comment">// reset the chronometer</span></div>
<div class="line">    <span class="comment">// trace away half of the qubits</span></div>
<div class="line">    <a class="code" href="namespaceqpp.html#ae846df6b2525ef728947e00c2074e8b6">ptrace2</a>(randcmat,</div>
<div class="line">            { (std::size_t) std::sqrt(N), (std::size_t) std::sqrt(N) });</div>
<div class="line">    t.<a class="code" href="classqpp_1_1_timer.html#a5b2954adbc31fba4131592609c01db32">toc</a>(); <span class="comment">// read the time</span></div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Took &quot;</span> &lt;&lt; t &lt;&lt; <span class="stringliteral">&quot; seconds.&quot;</span> &lt;&lt; endl;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// ptrace</span></div>
<div class="line">    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;ptrace timing.&quot;</span> &lt;&lt; endl;</div>
<div class="line">    vector&lt;std::size_t&gt; subsys_ptrace = { 0 };</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Subsytem(s): &quot;</span>;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#aa2d8bf1af1766aba47d6a3c953478aaa">displn</a>(subsys_ptrace, <span class="stringliteral">&quot;, &quot;</span>);</div>
<div class="line">    t.<a class="code" href="classqpp_1_1_timer.html#ae1bb3eb8a0f7851ba52005fab35e1c03">tic</a>();</div>
<div class="line">    <a class="code" href="namespaceqpp.html#a5fef47d40c93533b586f9b90a97c3621">ptrace</a>(randcmat, subsys_ptrace, dims);</div>
<div class="line">    t.<a class="code" href="classqpp_1_1_timer.html#a5b2954adbc31fba4131592609c01db32">toc</a>();</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Took &quot;</span> &lt;&lt; t &lt;&lt; <span class="stringliteral">&quot; seconds.&quot;</span> &lt;&lt; endl;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// ptranspose</span></div>
<div class="line">    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;ptranspose timing.&quot;</span> &lt;&lt; endl;</div>
<div class="line">    vector&lt;std::size_t&gt; subsys_ptranspose; <span class="comment">// partially transpose n-1 subsystems</span></div>
<div class="line">    <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; n - 1; i++)</div>
<div class="line">        subsys_ptranspose.push_back(i);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Subsytem(s): &quot;</span>;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#aa2d8bf1af1766aba47d6a3c953478aaa">displn</a>(subsys_ptranspose, <span class="stringliteral">&quot;, &quot;</span>);</div>
<div class="line">    t.<a class="code" href="classqpp_1_1_timer.html#ae1bb3eb8a0f7851ba52005fab35e1c03">tic</a>();</div>
<div class="line">    <a class="code" href="namespaceqpp.html#a0893a2a4dcfd11696a0e675da03f8f61">ptranspose</a>(randcmat, subsys_ptranspose, dims);</div>
<div class="line">    t.<a class="code" href="classqpp_1_1_timer.html#a5b2954adbc31fba4131592609c01db32">toc</a>();</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Took &quot;</span> &lt;&lt; t &lt;&lt; <span class="stringliteral">&quot; seconds.&quot;</span> &lt;&lt; endl;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// syspermute</span></div>
<div class="line">    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;syspermute timing.&quot;</span> &lt;&lt; endl;</div>
<div class="line">    vector&lt;std::size_t&gt; perm; <span class="comment">// left-shift all subsystems by 1</span></div>
<div class="line">    <span class="keywordflow">for</span> (std::size_t i = 0; i &lt; n; i++)</div>
<div class="line">        perm.push_back((i + 1) % n);</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Subsytem(s): &quot;</span>;</div>
<div class="line">    <a class="code" href="namespaceqpp.html#aa2d8bf1af1766aba47d6a3c953478aaa">displn</a>(perm, <span class="stringliteral">&quot;, &quot;</span>);</div>
<div class="line">    t.<a class="code" href="classqpp_1_1_timer.html#ae1bb3eb8a0f7851ba52005fab35e1c03">tic</a>();</div>
<div class="line">    <a class="code" href="namespaceqpp.html#af97cab67fadb870ad19be297b4422ca1">syspermute</a>(randcmat, perm, dims);</div>
<div class="line">    t.<a class="code" href="classqpp_1_1_timer.html#a5b2954adbc31fba4131592609c01db32">toc</a>();</div>
<div class="line">    cout &lt;&lt; <span class="stringliteral">&quot;Took &quot;</span> &lt;&lt; t &lt;&lt; <span class="stringliteral">&quot; seconds.&quot;</span> &lt;&lt; endl;</div>
<div class="line"></div>
<div class="line">    <span class="comment">//   // matrix product</span></div>
<div class="line">    <span class="comment">//   cout &lt;&lt; endl &lt;&lt; &quot;Matrix product timing.&quot; &lt;&lt; endl;</span></div>
<div class="line">    <span class="comment">//   t.tic(); // reset the chronometer</span></div>
<div class="line">    <span class="comment">//   cmat prodmat = randcmat * randcmat; // explicit cmat now</span></div>
<div class="line">    <span class="comment">//   t.toc(); // read the time</span></div>
<div class="line">    <span class="comment">//   cout &lt;&lt; &quot;Took &quot; &lt;&lt; t &lt;&lt; &quot; seconds.&quot; &lt;&lt; endl;</span></div>
<div class="line"></div>
<div class="line">    <span class="comment">// END TIMING</span></div>
<div class="line">    total.<a class="code" href="classqpp_1_1_timer.html#a5b2954adbc31fba4131592609c01db32">toc</a>(); <span class="comment">// read the total running time</span></div>
<div class="line">    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;Total time: &quot;</span> &lt;&lt; total.<a class="code" href="classqpp_1_1_timer.html#aaaa3d575c39a0cc38bf2291e723a1cea">seconds</a>() &lt;&lt; <span class="stringliteral">&quot; seconds.&quot;</span>;</div>
<div class="line">    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;Exiting qpp...&quot;</span> &lt;&lt; endl;</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Oct 23 2014 22:30:06 for quantum++ by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.7 </li>
  </ul>
</div>
</body>
</html>
